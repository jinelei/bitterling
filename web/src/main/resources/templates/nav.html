<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>我的导航</title>
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <script src="/js/tailwind.min.js"></script>
    <script src="/js/nav.js"></script>
    <link href="/css/font-awesome.min.css" rel="stylesheet">
    <link href="/css/nav.css" rel="stylesheet">
</head>

<body class="bg-gray-50 dark:bg-dark-bg text-gray-800 dark:text-gray-100 min-h-screen font-inter ">
<header id="header">
    <div class="container mx-auto px-4 py-4 flex flex-col md:flex-row items-center justify-between">
        <div class="flex items-center mb-4 md:mb-0">
            <h1 class="text-[clamp(2rem,5vw,3rem)] font-bold mb-2 bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent greeting-animation">
                <span id="user" style="cursor: pointer; user-select: none">美丽人生</span>
                <span>，</span>
                <span id="greeting" style="cursor: pointer">早上好</span>
                <span>！</span>
            </h1>
        </div>
        <div class="w-full md:w-auto relative flex-grow md:flex-grow-0 md:max-w-md">
            <input type="text"
                   id="search-input"
                   placeholder="搜索书签..."
                   class="w-full px-4 py-2 pl-10 rounded-full border border-neutral-200 focus:border-primary text-primary focus:ring-2 focus:ring-primary/20 focus:outline-none transition-all-300"/>
            <i class="fa fa-search absolute left-4 top-1/2 transform -translate-y-1/2 text-neutral-400"></i>
        </div>
    </div>
</header>

<main class="flex-grow container mx-auto px-4 py-8">
    <p th:text="${tag}"></p>
    <div id="category-tabs"
         class="flex overflow-x-auto pb-4 mb-8 scrollbar-hide space-x-2 md:justify-center">
        <button th:each="tag : ${tags}"
                th:class="'category-tab px-4 py-2 rounded-full whitespace-nowrap transition-all-300 hover:bg-neutral-100'"
                th:attr="data-category=${tag.key}"
                th:text="${tag.value}">
            分类占位
        </button>
    </div>

    <div id="bookmark-grid"
         class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4 md:gap-6">
        <a th:each="bookmark : ${bookmarkByTags[__${tag?:'全部'}__]}"
           th:href="${bookmark.url}"
           target="_blank"
           th:class="'bookmark-card group bg-primary/10 rounded-xl shadow-card hover:shadow-card-hover p-4 flex flex-col items-center justify-center transition-all-300 transform hover:-translate-y-1'"
           th:attr="data-category=${bookmark.parentId}"
           th:data-name="${bookmark.name}">
            <div th:class="'w-12 h-12 rounded-full ' + ${bookmark.name} + '/10 flex items-center justify-center mb-3 group-hover:' + ${bookmark.name} + '/20 transition-all-300'">
                <i th:class="'fa ' + ${bookmark.icon} + ' text-xl'" th:style="'color: ' + ${bookmark.name}"></i>
            </div>
            <h3 class="text-center font-medium" th:text="${bookmark.name}">
                书签名称
            </h3>
        </a>
    </div>
</main>

<footer class="py-6 mt-12">
    <div class="container mx-auto px-4 text-center text-neutral-500 text-sm">
        <p>jinelei.com © 2025</p>
    </div>
</footer>

<script>
    // 问候语功能
    function updateGreeting() {
        const hour = new Date().getHours();
        let greeting;

        if (hour >= 5 && hour < 9) {
            greeting = "早上好";
        } else if (hour >= 9 && hour < 12) {
            greeting = "上午好";
        } else if (hour >= 12 && hour < 14) {
            greeting = "中午好";
        } else if (hour >= 14 && hour < 18) {
            greeting = "下午好";
        } else if (hour >= 18 && hour < 22) {
            greeting = "晚上好";
        } else {
            greeting = "夜深了";
        }

        const greetingElement = document.getElementById("greeting");
        greetingElement.style.opacity = "0";

        // 淡入动画效果
        setTimeout(() => {
            greetingElement.textContent = greeting;
            greetingElement.style.opacity = "1";
        }, 300);
    }

    // 搜索功能
    function searchBookmark() {
        const categoryTabs = document.querySelectorAll(".category-tab");
        const bookmarkCards = document.querySelectorAll(".bookmark-card");
        categoryTabs.forEach((tab) => {
            tab.addEventListener("click", function () {
                categoryTabs.forEach((t) => {
                    t.classList.remove("bg-primary", "text-white");
                    t.classList.add("bg-secondary", "text-dark", "hover:bg-neutral-100");
                });
                this.classList.remove(
                    "bg-secondary",
                    "text-dark",
                    "hover:bg-neutral-100"
                );
                this.classList.add("bg-primary", "text-white");

                const category = this.getAttribute("data-category");
                bookmarkCards.forEach((card) => {
                    if (
                        !!!category ||
                        card.getAttribute("data-category") === category
                    ) {
                        card.style.display = "flex";
                        setTimeout(() => {
                            card.style.opacity = "1";
                            card.style.transform = "translateY(0)";
                        }, 50);
                    } else {
                        card.style.opacity = "0";
                        card.style.transform = "translateY(10px)";
                        setTimeout(() => {
                            card.style.display = "none";
                        }, 300);
                    }
                });
            });
        });
        const searchInput = document.getElementById("search-input");
        searchInput.addEventListener("input", function () {
            const searchTerm = this.value.toLowerCase().trim();
            bookmarkCards.forEach((card) => {
                const cardName = card.dataset.name.toLowerCase();
                if (cardName.includes(searchTerm)) {
                    card.style.display = "flex";
                    card.style.opacity = "1";
                    card.style.transform = "translateY(0)";
                } else {
                    card.style.opacity = "0";
                    card.style.transform = "translateY(10px)";
                    setTimeout(() => {
                        card.style.display = "none";
                    }, 300);
                }
            });
        });
    }

    searchBookmark();
    updateGreeting();
    window.addEventListener("scroll", () => {
        const header = document.getElementById("header");
        if (window.scrollY > 10) {
            header.classList.add("py-2", "shadow");
            header.classList.remove("py-4", "shadow-sm");
        } else {
            header.classList.add("py-4", "shadow-sm");
            header.classList.remove("py-2", "shadow");
        }
    });


    // 主题切换功能
    const themeToggle = document.getElementById('greeting');

    // 初始化主题
    if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
        document.documentElement.classList.add('dark');
    } else {
        document.documentElement.classList.remove('dark');
    }

    themeToggle.addEventListener('click', () => {
        console.log('clicked', document.documentElement.classList);
        document.documentElement.classList.toggle('dark');
        localStorage.theme = document.documentElement.classList.contains('dark') ? 'dark' : 'light';
    });
</script>
</body>
</html>
